ALTER SESSION SET current_schema = CONSINCO;   
  
SELECT * FROM (

SELECT F.NROEMPRESA EMP, GE.NOMERAZAO FORNECEDOR, F.NROTITULO, F.DTAVENCIMENTO, F.ABERTOQUITADO STATUS,
       F.VLRORIGINAL, FI.VLRDESCCONTRATO, FI.PERCDESCCONTRATO, ROUND(((FI.VLRDESCCONTRATO/F.VLRORIGINAL) * 100),2) PERC_CORRETO,
      (FI.PERCDESCCONTRATO - ROUND((FI.VLRDESCCONTRATO/F.VLRORIGINAL) * 100)) DIF_PERC
       
FROM FI_TITULO F LEFT JOIN FI_COMPLTITULO FI ON F.SEQTITULO = FI.SEQTITULO
                      JOIN GE_PESSOA      GE ON F.SEQPESSOA = GE.SEQPESSOA,
                     
                      
WHERE FI.PERCDESCCONTRATO > 0
  AND F.QTDPARCELA = 1
  AND F.DTAVENCIMENTO > DATE '2022-01-01'
)
  
WHERE DIF_PERC > 0    
ORDER BY DIF_PERC DESC;
