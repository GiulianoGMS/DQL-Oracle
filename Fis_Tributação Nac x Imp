ALTER SESSION SET current_schema = CONSINCO;

SELECT 'IMP com origem NAC' TIPO, A.SEQFAMILIA, A.CODORIGEMTRIB, A.NROTRIBUTACAO, B.TRIBUTACAO
FROM MAP_FAMDIVISAO A LEFT JOIN MAP_TRIBUTACAO B ON A.NROTRIBUTACAO = B.NROTRIBUTACAO

WHERE UPPER(TRIBUTACAO) LIKE '%IMP%'      AND CODORIGEMTRIB NOT IN (1,2,3,7) AND UPPER(TRIBUTACAO) NOT LIKE '%LIMP%'
   OR UPPER(TRIBUTACAO) LIKE '%IMP.LIMP%' AND CODORIGEMTRIB NOT IN (1,2,3,7) 

UNION ALL

SELECT 'NAC com origem IMP' TIPO, A.SEQFAMILIA, A.CODORIGEMTRIB, A.NROTRIBUTACAO, B.TRIBUTACAO
FROM MAP_FAMDIVISAO A LEFT JOIN MAP_TRIBUTACAO B ON A.NROTRIBUTACAO = B.NROTRIBUTACAO

WHERE TRIBUTACAO NOT LIKE '%IMP%'   AND CODORIGEMTRIB IN (1,2,3,7)
   OR TRIBUTACAO     LIKE '%LIMP%' AND CODORIGEMTRIB  IN (1,2,3,7) AND TRIBUTACAO NOT LIKE 'IMP%'

ORDER BY 1,5;
